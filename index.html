

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spotlight &mdash; Spotlight 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/spotlight_theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Spotlight 0.1.0 documentation" href="#"/>
        <link rel="next" title="Interactions" href="interactions.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#">
          

          
            
            <img src="_static/spotlight.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="interactions.html">Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets/datasets.html">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datasets/synthetic.html">Synthetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets/movielens.html">Movielens</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cross_validation.html">Cross validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence/sequence.html">Sequence models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sequence/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequence/representations.html">Sequence representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="factorization/factorization.html">Factorization models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="factorization/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorization/explicit.html">Explicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorization/representations.html">Latent representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Spotlight</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Spotlight</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <img alt="_images/spotlight.png" src="_images/spotlight.png" />
<hr class="docutils" />
<a class="reference external image-reference" href="https://travis-ci.org/maciejkula/spotlight"><img alt="https://travis-ci.org/maciejkula/spotlight.svg?branch=master" src="https://travis-ci.org/maciejkula/spotlight.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://gitter.im/spotlight-recommendations/Lobby"><img alt="https://badges.gitter.im/gitterHQ/gitter.png" src="https://badges.gitter.im/gitterHQ/gitter.png" /></a>
<a class="reference external image-reference" href="https://anaconda.org/maciejkula/spotlight"><img alt="https://anaconda.org/maciejkula/spotlight/badges/version.svg" src="https://anaconda.org/maciejkula/spotlight/badges/version.svg" /></a>
<a class="reference external image-reference" href="https://maciejkula.github.io/spotlight/"><img alt="https://img.shields.io/badge/docs-latest-brightgreen.svg?style=flat" src="https://img.shields.io/badge/docs-latest-brightgreen.svg?style=flat" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Spotlight uses <a class="reference external" href="http://pytorch.org/">PyTorch</a> to build both deep and shallow
recommender models. By providing both a slew of building blocks for loss functions
(various pointwise and pairwise ranking losses), representations (shallow
factorization representations, deep sequence models), and utilities for fetching
(or generating) recommendation datasets, it aims to be a tool for rapid exploration
and prototyping of new recommender models.</p>
<p>See the full <a class="reference external" href="https://maciejkula.github.io/spotlight/">documentation</a> for details.</p>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">maciejkula</span> <span class="o">-</span><span class="n">c</span> <span class="n">soumith</span> <span class="n">spotlight</span><span class="o">=</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="factorization-models">
<h1>Factorization models<a class="headerlink" href="#factorization-models" title="Permalink to this headline">¶</a></h1>
<p>To fit an explicit feedback model on the MovieLens dataset:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="k">import</span> <span class="n">random_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.datasets.movielens</span> <span class="k">import</span> <span class="n">get_movielens_dataset</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="k">import</span> <span class="n">rmse_score</span>
<span class="kn">from</span> <span class="nn">spotlight.factorization.explicit</span> <span class="k">import</span> <span class="n">ExplicitFactorizationModel</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">get_movielens_dataset</span><span class="p">(</span><span class="n">variant</span><span class="o">=</span><span class="s1">&#39;100K&#39;</span><span class="p">)</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">random_train_test_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ExplicitFactorizationModel</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="n">rmse</span> <span class="o">=</span> <span class="n">rmse_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
<p>To fit an implicit ranking model with a BPR pairwise loss on the MovieLens dataset:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="k">import</span> <span class="n">random_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.datasets.movielens</span> <span class="k">import</span> <span class="n">get_movielens_dataset</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="k">import</span> <span class="n">mrr_score</span>
<span class="kn">from</span> <span class="nn">spotlight.factorization.implicit</span> <span class="k">import</span> <span class="n">ImplicitFactorizationModel</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">get_movielens_dataset</span><span class="p">(</span><span class="n">variant</span><span class="o">=</span><span class="s1">&#39;100K&#39;</span><span class="p">)</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">random_train_test_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ImplicitFactorizationModel</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                   <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;bpr&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="n">mrr</span> <span class="o">=</span> <span class="n">mrr_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sequential-models">
<h1>Sequential models<a class="headerlink" href="#sequential-models" title="Permalink to this headline">¶</a></h1>
<p>Recommendations can be seen as a sequence prediction task: given the items a user
has interacted with in the past, what will be the next item they will interact
with? Spotlight provides a range of models and utilities for fitting next item
recommendation models, including</p>
<ul class="simple">
<li>pooling models, as in <a class="reference external" href="https://pdfs.semanticscholar.org/bcdb/4da4a05f0e7bc17d1600f3a91a338cd7ffd3.pdf">YouTube recommendations</a>,</li>
<li>LSTM models, as in <a class="reference external" href="https://arxiv.org/pdf/1511.06939">Session-based recommendations…</a>, and</li>
<li>causal convolution models, as in <a class="reference external" href="https://arxiv.org/pdf/1609.03499">WaveNet</a>.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="k">import</span> <span class="n">user_based_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.datasets.synthetic</span> <span class="k">import</span> <span class="n">generate_sequential</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="k">import</span> <span class="n">sequence_mrr_score</span>
<span class="kn">from</span> <span class="nn">spotlight.sequence.implicit</span> <span class="k">import</span> <span class="n">ImplicitSequenceModel</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">generate_sequential</span><span class="p">(</span><span class="n">num_users</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                              <span class="n">num_items</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                              <span class="n">num_interactions</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                              <span class="n">concentration_parameter</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                              <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">user_based_train_test_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">to_sequence</span><span class="p">()</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">to_sequence</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ImplicitSequenceModel</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                              <span class="n">representation</span><span class="o">=</span><span class="s1">&#39;cnn&#39;</span><span class="p">,</span>
                              <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;bpr&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="n">mrr</span> <span class="o">=</span> <span class="n">sequence_mrr_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="datasets">
<h1>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h1>
<p>Spotlight offers a slew of popular datasets, including Movielens 100K, 1M, 10M, and 20M.
It also incorporates utilities for creating synthetic datasets. For example, <cite>generate_sequential</cite>
generates a Markov-chain-derived interaction dataset, where the next item a user chooses is
a function of their previous interactions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spotlight.datasets.synthetic</span> <span class="k">import</span> <span class="n">generate_sequential</span>

<span class="c1"># Concentration parameter governs how predictable the chain is;</span>
<span class="c1"># order determins the order of the Markov chain.</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">generate_sequential</span><span class="p">(</span><span class="n">num_users</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                              <span class="n">num_items</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                              <span class="n">num_interactions</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                              <span class="n">concentration_parameter</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                              <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://github.com/maciejkula/spotlight/tree/master/examples/movielens_explicit">Rating prediction on the Movielens dataset</a>.</li>
<li><a class="reference external" href="https://github.com/maciejkula/spotlight/tree/master/examples/movielens_sequence">Using causal convolutions for sequence recommendations</a>.</li>
</ol>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Spotlight is meant to be extensible: pull requests are welcome. In particular, we accept implementations of new recommendation models into the Spotlight model zoo: if you’ve just published a paper describing your new model, or have an implementation of a model from the literature, make a PR!</p>
</div>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="interactions.html">Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets/datasets.html">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datasets/synthetic.html">Synthetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets/movielens.html">Movielens</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cross_validation.html">Cross validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence/sequence.html">Sequence models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sequence/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequence/representations.html">Sequence representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="factorization/factorization.html">Factorization models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="factorization/implicit.html">Implicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorization/explicit.html">Explicit feedback models</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorization/representations.html">Latent representations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling</a></li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="interactions.html" class="btn btn-neutral float-right" title="Interactions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Maciej Kula.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>